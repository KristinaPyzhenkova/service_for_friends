# service_for_friends



## Описание проекта.
Проект service_for_friends предоставляет пользователю возможность:
зарегистрировать нового пользователя 
отправить одному пользователю заявку в друзья другому 
принять/отклонить пользователю заявку в друзья от другого пользователя 
посмотреть пользователю список своих исходящих и входящих заявок в друзья 
посмотреть пользователю список своих друзей 
получить пользователю статус дружбы с каким-то другим пользователем (Нет ничего / Исходящая заявка / Входящая заявка / Уже друзья / Это ты!)
удалить пользователю другого пользователя из своих друзей
если пользователь1 отправляет заявку в друзья пользователю2, а пользователь2 отправляет заявку пользователю1, то они автоматом становятся друзьями, их заявки автоматом принимаются 

Данный проект реализован на библиотеке djangorestframework.

## Как запустить проект: 
Пересобрать контейнер и запустить контейнер:
```
docker-compose up -d --build
```
Создать суперпользователя:
```
docker exec -it friend_web python manage.py createsuperuser
```
Cобрать статику:
```
docker exec -it friend_web python manage.py collectstatic --no-input
```
Проект доступен по адресу (далее url):
```
http://localhost/
```
### Примеры обращений к API:

Swagger доступен по след. Пути:
``` http://{url}/api/ ```

### Примеры обращений к API:

#### Самостоятельно зарегистрироваться и получить код подтвердения для получения токена:

Обратиться по методу Post на - ``` http://{url}/api/new_user/ ```
В теле запроса передать параметры username, password и их значения. После этого, если пользователь имеет уникальный username и не был зарегистрирован ранее -  произойдет его регистрация, если пользователь уже существует, то регистрация не произойдет:
Пример тела запроса:
```
{
    "username": "Test",
    "password": "password12345"
}

```
#### Получить токен для авторизации пользователя:

Обратиться по методу Post на - ``` http://{url}/api/token/ ```
В теле запроса передать параметры username, password и их значения.
Полученный токен использовать для авторизации, например:
Authorization: Token f066f0b570e35641269a87c1e393be011a0529e0.
Пример тела запроса:
```
{
    "username": "Test",
    "password": "password12345"
}

```
Пример ответа:
```
{
  "token": "e481ae17627609c87c70f8a65e67fa9e95193a58"
}
```
#### Отправить одному пользователю заявку в друзья другому:

Метод POST - ``` http://{url}/api/application/send/```
Данный метод работает только после авторизации (необходим токен).
Для отправки заявки в друзья - необходимо в тело запроса передать username интересующего Вас пользователя в параметр applicant:

Пример тела запроса:
```
{
    "applicant": "Test3"
}
```

Пример успешного ответа:
```
{
  "id": 7,
  "user": "Test",
  "applicant": "Test_Friend",
  "created_at": "2023-05-10T06:55:30.934934Z"
}
```
Пример ответа, если заявка существует:
```
{
  "status": "error",
  "code": 400,
  "message": "Application with this user and applicant already exists."
}
```
Пример ответа, если пользователь1 отправляет заявку в друзья пользователю2, а пользователь2 отправляет заявку пользователю1:
```
{
  "status": "success",
  "code": 201,
  "message": "You became friends."
}
```
Пример ответа, если заявку отправить себе:
```
{
  "status": "error",
  "code": 400,
  "message": "You can't add yourself as a friend."
}
```
Пример ответа, если заявку отправить другу:
```
{
  "status": "error",
  "code": 400,
  "message": "You are already friends."
}
```
#### Принять/отклонить пользователю заявку в друзья от другого пользователя (доступно только авторизованному пользователю):

Обратиться по методу PUT на эндпойнт - ``` http://{url}//api/application/{username}/ ```
Параметр username - юзернейм пользователя, чью заявку хотим принять/отклонить.
В теле запроса параметр accept со значением true/false.
Тело запроса:
```
{
  "accept": true
}
```
Если вы принимаете заявку то успешный ответ:
```
{
  "status": "success",
  "code": 201,
  "message": "You became friends."
}
```
Если отклоняете заявку:
```
{
  "status": "success",
  "code": 201,
  "message": "Application rejected."
}
```
Если такой заявки не существует - ответ:
```
{
  "status": "error",
  "code": 400,
  "message": "There are no such requests to accept / reject - send a request first."
}
```

#### Посмотреть пользователю список своих исходящих и входящих заявок в друзья (доступно только авторизованному пользователю):

Обратиться по методу Get на эндпойнт для получения входящих заявок - ``` http://{url}/api/application/incoming/ ```
Обратиться по методу Get на эндпойнт для получения исходящих заявок - ``` http://{url}/api/application/outgoing/ ```
Ответ:
```
[

  {

    "id": 11,
    "user": "Test",
    "applicant": "Test2",
    "created_at": "2023-05-10T07:33:27.428309Z"
  },
  {

    "id": 10,
    "user": "Test",
    "applicant": "Test3",
    "created_at": "2023-05-10T07:30:41.146129Z"
  }
]

```
#### Посмотреть пользователю список своих друзей(доступно только авторизованному пользователю):

Метод Get - ``` http://{url}/api/friend/```
Успешный ответ(user в ответе - юзернейм твоего друга):
```
[
  {

    "user": "Test_q"
  },
  {

    "user": "Test3"
  }
]
```
#### Удалить пользователю другого пользователя из своих друзей:
Доступно только авторизованным пользователям.

Метод PUT - ``` http://{url}/api/friend/{username}/```
username - юзернейм юзера, которого хочешь удалить
Успешный ответ:
```
{
  "status": "success",
  "code": 204,
  "message": "You unfriended user {username}.»
}
```
Если пользователя нет в друзьях:
```
{
  "status": "error",
  "code": 400,
  "message": "You don't have this user as a friend."
}
```

#### Получить пользователю статус дружбы с каким-то другим пользователем (Нет ничего / Исходящая заявка / Входящая заявка / Уже друзья / Это ты!).
Доступно только авторизованным пользователям.

Метод GET - ``` http://{url}/api/status/{username}/```
username - юзернейм юзера, c кем статус ты хочешь узнать

Пример успешного ответа:
```
{
  "username": "Test_t",
  "status": "Нет ничего"
}
```
Пример ответа, если указать несуществующий юзернейм:
```
{
  "status": "error",
  "message": "The specified username does not exist."
}
```
Список статусов: Нет ничего / Исходящая заявка / Входящая заявка / Уже друзья / Это ты!

